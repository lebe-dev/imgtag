# imgtag

Разметка JPG-файлов согласно иерархии хранения.

## Что делает утилита

1. На входе принимает каталог с изображениями, рекурсивно собирает имена файлов.
2. Извлекает из EXIF дату создания снимка.
3. Создаёт в каталоге назначения файл с новым именем в формате:
   ```
   ГГГГ/МЕСЯЦ/ГГГГ-ММ-ДД__ЧЧ-ММ-СС__имя-файла.jpg
   ```

## Команды

### Копирование файлов согласно структуре

Команда `reorganize` позволяет структурировать исходный файловый архив по датам в каталоге назначения.

```
imgtag reorganize [ОПЦИИ] <исходный-каталог> <каталог-назначения>
```

Пример:

```
imgtag /home/user/camera /data/output
```

Файл `IMG39284.JPG` с датой создания в EXIF `2019.07.13` будет скопирован и назван следующим образом:

```
/data/output/2019/Июль/2019-07-13__13-12-57__IMG39284.jpg
```

### Диагностика каталога

Команда `diag` обнаруживает файлы без EXIF и для которых не удалось восстановить дату по именам каталогов.

Пример использования:

```
imgtag.exe diag --skip-dir-names-for-date-extract takeout e:\tmp\sources
extract dates from path: true
Started: Sat, 28 Nov 2020 20:46:20 +0300
Getting files list..
Files total: 151515 (with issues: 28)
---
Unable to determine date for file(s):
e:\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\e5eaK_m3-8Y.jpg
e:\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\gen6_0036.micro.jpg
e:\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\i-137.jpg
e:\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\i-67.jpg
...
```


## Опции

### Поведение для файлов без информации в EXIF или без EXIF

#### Не извлекать дату из пути к файлу

По умолчанию, утилита пытается извлекать дату из пути к файлу, если не смогла извлечь из EXIF.

Опция: `--dont-extract-date-from-path` отключает эту функциональность.

#### Не извлекать дату из имен каталогов соответствующим маскам

Бывают ситуации когда на одном из уровней содержится каталог из которого не нужно пытаться извлекать дату.

Например, после выгрузки файлов из Google Photo сервисом Google Takeout получается структура вида:

```
e:\tmp\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\e5eaK_m3-8Y.jpg
e:\tmp\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\gen6_0036.micro.jpg
e:\tmp\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\i-137.jpg
e:\tmp\sources\takeout-20201103T072301Z-002\Takeout\Google Фото\id\i-67.jpg
```

Каталоги с takeout содержат дату на момент извлечения фотографий из сервиса, эта дата бесполезна. С помощью опции
`--skip-dir-names-for-date-extract` можно указать маски (через запятую) для игнорирования имён каталогов.

Утилита не будет пытаться извлекать дату из каталогов, имя которых начинается с указанных масок. 

Пример:
```
imgtag diag --skip-dir-names-for-date-extract Takeout e:\images
```

## В чём преимущества разметки?

Понятие [файла](https://ru.wikipedia.org/wiki/%D0%A4%D0%B0%D0%B9%D0%BB) было сформулировано ещё в 1950 году и 
они до сих пор актуальны. Файлы просты в обращении.

Преимущества разметки:

1. Быстрый доступ к информации.  
   Для поиска файла достаточно любого ПО которое умеет искать по именам файлов. Например, [Everything](https://www.voidtools.com/ru-ru/);
   
2. Независимость от программного обеспечения.  
   1. Поддержка всех популярных операционных систем
   2. Не нужна база данных чтобы хранить мета-информацию. Базой выступает имя файла. Копируя файлы, копируется и мета-информация;
   
3. Не нужен доступ к сети.
